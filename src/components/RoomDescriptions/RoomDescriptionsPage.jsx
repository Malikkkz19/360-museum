import React, { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import "./RoomDescriptionsPage.css";
import yellowRocket from "../../assets/halls/yellow_rocket.png";

function RoomDescriptionsPage() {
  const navigate = useNavigate();
  const [expandedRooms, setExpandedRooms] = useState({});

  const handleBackClick = () => {
    navigate("/");
  };

  const toggleRoomExpand = (roomId, e) => {
    // Предотвращаем всплытие, чтобы кликом по содержимому не закрывался зал
    e.stopPropagation();

    setExpandedRooms((prev) => {
      // Если зал уже открыт, то закрываем его
      if (prev[roomId]) {
        return {
          ...prev,
          [roomId]: false,
        };
      }
      // Иначе закрываем все залы и открываем только выбранный
      return {
        [roomId]: true,
      };
    });
  };

  // Добавляем хук useEffect для правильной инициализации прокрутки
  useEffect(() => {
    // Убеждаемся, что контейнер с содержимым может прокручиваться
    const contentElement = document.querySelector(".room-descriptions-content");
    if (contentElement) {
      contentElement.style.overflowY = "auto";
    }

    // Функция для включения прокрутки
    const handleScroll = (e) => {
      // Разрешаем стандартное поведение прокрутки
      e.stopPropagation();
    };

    // Добавляем обработчики событий
    window.addEventListener("wheel", handleScroll, { passive: true });

    // Очищаем обработчики при размонтировании компонента
    return () => {
      window.removeEventListener("wheel", handleScroll);
    };
  }, []);

  return (
    <div className="room-descriptions-page">
      {/* Мерцающие точки-звезды */}
      <div className="twinkling-stars">
        {Array.from({ length: 25 }, (_, i) => (
          <div key={`star-${i}`} className={`star-dot star-dot-${i + 1}`}></div>
        ))}
      </div>

      <div className="room-descriptions-content">
        {/* Заголовок */}
        <div className="room-descriptions-header">
          <div className="room-descriptions-title">
            <h1>ОПИСАНИЕ</h1>
            <h1>ЗАЛОВ</h1>
          </div>
        </div>

        {/* Содержимое страницы с описаниями залов */}
        <div className="room-descriptions-container">
          {[1, 2, 3, 4, 5, 6].map((roomNumber) => (
            <div
              key={`room-${roomNumber}`}
              className={`room-description ${
                expandedRooms[`room-${roomNumber}`] ? "expanded" : ""
              }`}
              onClick={(e) => toggleRoomExpand(`room-${roomNumber}`, e)}
            >
              <div className="room-header">
                <h2>ЗАЛ {roomNumber}</h2>
                <div className="expand-icon">
                  {expandedRooms[`room-${roomNumber}`] ? "−" : "+"}
                </div>
              </div>

              <div
                className={`room-content ${
                  expandedRooms[`room-${roomNumber}`] ? "expanded" : ""
                }`}
              >
                <div className="room-images">
                  <img
                    src={`/images/${roomNumber}.png`}
                    alt={`Зал ${roomNumber}`}
                  />
                </div>
                <p>
                  {roomNumber === 1 &&
                    "Посвящен периоду с 1712 по 1918г. Здесь показана история Академии, начиная с создания ещё при Петре I Инженерной школы, ставшей затем артиллерийской и инженерной школой, затем шляхетским корпусом и, наконец, 2-м кадетским корпусом. Несколько стендов посвящены истории военных учебных заведений, ныне вошедших в Академию: Топографического училища, Владимирского и Павловского Военных училищ. Один из стендов посвящён генералу Засядко, создателю первых боевых ракет в России."}
                  {roomNumber === 2 &&
                    "Посвящён периоду с 1918 по 1941г. Показана история Петроградской школы техников-механиков Красного воздушного флота, открытой в зданиях 2-го Кадетского корпуса в 1922г., а также Военно-Теоретической школы Воздушных сил РККА, располагавшейся в здании бывшего Павловского училища начиная с 1924 года.  Рассказывается  история Ленинградского институт инженеров гражданского воздушного флота (ЛИИ ГВФ), на базе которого в условиях угрозы войны 27 марта 1941 года Приказом народного комиссара обороны Союза ССР в Пулково была создана Ленинградская военно-воздушная академия Красной Армии. "}
                  {roomNumber === 3 &&
                    "Посвящен периоду 1941-1957г. Здесь рассказывается от деятельности академии в эвакуации в Йошкар-Оле, возвращении её в Ленинград, награждении Орденом Красного Звания и получении имени А.Ф. Можайского. Отдельный стенд посвящен самому великому русскому изобретателю, чьё имя носит академия, контр-адмиралу А.Ф. Можайскому, и его знаменитому изобретению – летательному аппарату тяжелее воздуха, созданному за 20 лет до братьев Райт. В зале также имеется экспозиция, посвящённая истории появления и развития ракетной техники в России и затем в СССР от пороховых боевых ракет 19-го века до запуска первого ИСЗ  и о переходе академии с подготовки кадров для ВВС на подготовку офицерских кадров для РВСН. В зале расположены находки  поискового отряда «Космос», существовавшего в академии в 90-е годы, а также макеты ракет ГИРД и и макет первого космического аппарата ИС-1, подаренного академии СП.Королёвым в 1961 году. "}
                  {roomNumber === 4 &&
                    "Космический зал музея посвящен истории Академии и её достижениям с начала 1960-х годов по настоящее время. В зале представлены макеты космических аппаратов, ракетные двигатели, скафандр и кресло космонавта, а также образцы космической техники, в том числе созданные в стенах Академии: макет ядерной энергоустановки «Топаз-2» и КА «Можаец»."}
                  {roomNumber === 5 &&
                    "Зал славы посвящен выдающимся людям, в разное время имевшим прямое отношение к Академии. Генерал-полковник Кизим Л.Д., генерал-лейтенант  Шумилин А.А., генерал-лейтенант Медведев Д.А., генерал-майор Гудилин В.Е., полковник Петухов Г.Б., генерал армии Антонов А.И., космонавт Шаргин Ю.Г., генерал-полковник Поповкин В.А. нашли достойное отражение на стендах и витринах зала, где представлены различные материалы, рассказывающие об этих людях, личные вещи, документы, награды."}
                  {roomNumber === 6 &&
                    "Лекционный, учебно-методический зал служит для  проведения лекций, семинаров, концференций и других. мероприятий,  связанных с  историей Академии и развития космической техники,  и имеет профориентационную направленность.  В зале представлены материалы по структуре, составу Академии в настоящее время, назначению и задачам входящих в неё факультетов."}
                </p>
              </div>
            </div>
          ))}
        </div>

        {/* Футер */}
        <div className="room-descriptions-footer">
          <button
            className="room-descriptions-back-button"
            onClick={handleBackClick}
          >
            <span className="back-arrow">←</span>
            <span className="back-text">назад</span>
          </button>
        </div>
      </div>
    </div>
  );
}

export default RoomDescriptionsPage;
